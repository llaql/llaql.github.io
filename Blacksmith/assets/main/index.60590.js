window.__require=function t(e,r,n){function i(s,c){if(!r[s]){if(!e[s]){var p=s.split("/");if(p=p[p.length-1],!e[p]){var a="function"==typeof __require&&__require;if(!c&&a)return a(p,!0);if(o)return o(p,!0);throw new Error("Cannot find module '"+s+"'")}s=p}var l=r[s]={exports:{}};e[s][0].call(l.exports,function(t){return i(e[s][1][t]||t)},l,l.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({Game:[function(t,e,r){"use strict";cc._RF.push(e,"578fbFojjFKHZQ1zwqUhqxy","Game");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};Object.defineProperty(r,"__esModule",{value:!0});var s=t("./Knife"),c=cc._decorator,p=c.ccclass,a=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.addBtn1=null,e.subBtn1=null,e.label1=null,e.addBtn2=null,e.subBtn2=null,e.label2=null,e.addBtn3=null,e.subBtn3=null,e.label3=null,e.knife=null,e.touchNode=null,e.buyBtn=null,e.anim=null,e.levels=[100,200,300,400],e.curLevel=0,e.tian=0,e.ger=0,e.spriteFrames=[],e.animLabel=null,e}return i(e,t),e.prototype.start=function(){var t=this.touchNode;t.on(cc.Node.EventType.TOUCH_START,this.touch,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.touch,this),this.label1.string=this.levels[this.curLevel]+""},e.prototype.touch=function(t){var e=this.touchNode.convertToNodeSpaceAR(t.getLocation());this.knife.rap(e)},e.prototype.reset=function(){this.anim.play("Idle"),this.knife.init(),this.anim.node.opacity=0},e.prototype.idle=function(){this.anim.play("Idle")},e.prototype.buy=function(){this.reset(),this.anim.node.opacity=255},e.prototype.play=function(){"Anim1"==this.anim.currentClip.name?(this.anim.play("Idle"),this.animLabel.string="Play"):(this.anim.play("Anim1"),this.animLabel.string="Idle")},e.prototype.upLevel=function(){this.curLevel+=1,this.curLevel>=this.levels.length&&(this.curLevel=this.levels.length-1),this.label1.string=this.levels[this.curLevel]+"",this.knife.updateSpriteFrame(this.spriteFrames[this.curLevel])},e.prototype.dnLevel=function(){this.curLevel-=1,this.curLevel<=0&&(this.curLevel=0),this.label1.string=this.levels[this.curLevel]+"",this.knife.updateSpriteFrame(this.spriteFrames[this.curLevel])},e.prototype.addTian=function(){this.tian+=1,this.tian>=5&&(this.tian=5),this.label2.string=this.tian+""},e.prototype.subTian=function(){this.tian-=1,this.tian<=0&&(this.tian=0),this.label2.string=this.tian+""},e.prototype.addGer=function(){this.ger+=1,this.ger>=5&&(this.ger=5),this.label3.string=this.ger+""},e.prototype.subGer=function(){this.ger-=1,this.ger<=0&&(this.ger=0),this.label3.string=this.ger+""},o([a(cc.Button)],e.prototype,"addBtn1",void 0),o([a(cc.Button)],e.prototype,"subBtn1",void 0),o([a(cc.Label)],e.prototype,"label1",void 0),o([a(cc.Button)],e.prototype,"addBtn2",void 0),o([a(cc.Button)],e.prototype,"subBtn2",void 0),o([a(cc.Label)],e.prototype,"label2",void 0),o([a(cc.Button)],e.prototype,"addBtn3",void 0),o([a(cc.Button)],e.prototype,"subBtn3",void 0),o([a(cc.Label)],e.prototype,"label3",void 0),o([a(s.default)],e.prototype,"knife",void 0),o([a(cc.Node)],e.prototype,"touchNode",void 0),o([a(cc.Button)],e.prototype,"buyBtn",void 0),o([a(cc.Animation)],e.prototype,"anim",void 0),o([a([cc.SpriteFrame])],e.prototype,"spriteFrames",void 0),o([a(cc.Label)],e.prototype,"animLabel",void 0),o([p],e)}(cc.Component);r.default=l,cc._RF.pop()},{"./Knife":"Knife"}],Knife:[function(t,e,r){"use strict";cc._RF.push(e,"083a6B6PklKxYAT8OvOfQ1A","Knife");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};Object.defineProperty(r,"__esModule",{value:!0});var s=t("./PolygonMask"),c=cc._decorator,p=c.ccclass,a=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mask=null,e.verts=[],e}return i(e,t),e.prototype.start=function(){window.aa=this},e.prototype.init=function(){for(var t=[],e=0,r=0;r<2;r++)for(var n=0;n<=10;n++){var i=cc.v2(0==r?50:-50,0);i.y=0==r?30*n-150:30*(10-n)-150,t.push(i),this.mask.vertexes[e]=i,e+=1}this.verts=t,this.reset()},e.prototype.reset=function(){for(var t=[],e=0;e<2;e++)for(var r=0;r<=10;r++){var n=cc.v2(0==e?50:-50,0);n.y=0==e?30*r-150:30*(10-r)-150,t.push(n)}this.verts=t,this.mask.vertexes=this.verts},e.prototype.rap=function(t){var e=this;this.verts.forEach(function(r,n){var i=cc.Vec2.distance(t,r);if(!(i<.01)){var o=t.sub(r).normalize(),s=10-i/10,c=(10-i/10)/10;if(!(s<5)){var p=r.sub(cc.v2(o.x*s,o.y*c));r.x>0&&p.x<5&&(p.x=r.x),r.x<0&&p.x>-5&&(p.x=r.x),r.x>0&&p.x>150&&(p.x=r.x),r.x<0&&p.x<-150&&(p.x=r.x),p.y<-150&&(p.y=-150),p.y>150&&(p.y=150),0!=n&&n!=e.verts.length-1||(p.y=r.y),e.verts[n]=p}}}),this.mask.vertexes=this.verts},e.prototype.updateSpriteFrame=function(t){this.mask.spriteFrame=t},o([a(s.default)],e.prototype,"mask",void 0),o([p],e)}(cc.Component);r.default=l,cc._RF.pop()},{"./PolygonMask":"PolygonMask"}],PolygonMask:[function(t,e,r){"use strict";cc._RF.push(e,"b37168l0VBBzJcDepXWWro5","PolygonMask");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s};Object.defineProperty(r,"__esModule",{value:!0});var s=cc.gfx,c=cc._decorator,p=c.ccclass,a=c.property,l=c.executeInEditMode,u=c.requireComponent,h=[cc.v2(-50,-50),cc.v2(50,-50),cc.v2(50,50),cc.v2(-50,50)],f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._editing=!1,e._offset=cc.v2(0,0),e._spriteFrame=null,e._vertexes=h,e._meshCache=null,e.renderer=null,e.mesh=null,e.texture=null,e}return i(e,t),Object.defineProperty(e.prototype,"editing",{get:function(){return this._editing},set:function(t){this._editing=t,this._applyVertexes()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offset",{get:function(){return this._offset},set:function(t){this._offset=t,this.editing&&this._applyVertexes()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spriteFrame",{get:function(){return this._spriteFrame},set:function(t){this._spriteFrame=t,this._applySpriteFrame()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertexes",{get:function(){return this._vertexes},set:function(t){this._vertexes=t,this._updateMesh(),this._applyVertexes()},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._meshCache={},this._updateMesh();var t=this.node.getComponent(cc.MeshRenderer);t.mesh=null,this.renderer=t;var e=cc.MaterialVariant.createWithBuiltin("unlit",this).material;t.setMaterial(0,e),this._applySpriteFrame(),this._applyVertexes()},e.prototype._updateMesh=function(){var t=this._meshCache[this.vertexes.length];t||((t=new cc.Mesh).init(new s.VertexFormat([{name:s.ATTR_POSITION,type:s.ATTR_TYPE_FLOAT32,num:2},{name:s.ATTR_UV0,type:s.ATTR_TYPE_FLOAT32,num:2}]),this.vertexes.length,!0),this._meshCache[this.vertexes.length]=t),this.mesh=t},e.prototype._applyVertexes=function(){var t=this,e=this.mesh,r=this.vertexes.map(function(e){return e.add(t.offset)});if(e.setVertices(s.ATTR_POSITION,r),this.texture){for(var n=[],i=0,o=r;i<o.length;i++){var c=o[i],p=(c.x+this.texture.width/2)/this.texture.width,a=1-(c.y+this.texture.height/2)/this.texture.height;n.push(cc.v2(p,a))}e.setVertices(s.ATTR_UV0,n)}if(this.vertexes.length>=3){for(var l=[],u=[].concat(r),h=0,f=-1;u.length>3;){var y=u[h%u.length],d=u[(h+1)%u.length],v=u[(h+2)%u.length],_=d.sub(y),b=v.sub(d);if(_.cross(b)>=0){for(var m=!1,g=0,x=u;g<x.length;g++){var O=x[g];if(O!==y&&O!==d&&O!==v&&this._testInTriangle(O,y,d,v)){m=!0;break}}if(m){if((h=(h+1)%u.length)===f){cc.log("\u5faa\u73af\u4e00\u5708\u672a\u53d1\u73b0");break}}else l=l.concat([r.indexOf(y),r.indexOf(d),r.indexOf(v)]),u.splice(u.indexOf(d),1),f=h}else if((h=(h+1)%u.length)===f){cc.log("\u5faa\u73af\u4e00\u5708\u672a\u53d1\u73b0");break}}l=l.concat(u.map(function(t){return r.indexOf(t)})),e.setIndices(l),this.renderer.mesh!=e&&(this.renderer.mesh=e)}},e.prototype._testInTriangle=function(t,e,r,n){var i=r.sub(e),o=n.sub(e),s=n.sub(r),c=t.sub(e),p=t.sub(r);return i.cross(o)>=0!=i.cross(c)<0&&i.cross(o)>=0!=o.cross(c)>=0&&s.cross(i)>0!=s.cross(p)>=0},e.prototype._applySpriteFrame=function(){if(this.spriteFrame){var t=this.renderer.getMaterial(0),e=this.spriteFrame.getTexture();t.define("USE_DIFFUSE_TEXTURE",!0),t.setProperty("diffuseTexture",e),this.texture=e}},o([a({serializable:!1,readonly:!0})],e.prototype,"_editing",void 0),o([a],e.prototype,"editing",null),o([a],e.prototype,"_offset",void 0),o([a],e.prototype,"offset",null),o([a({type:cc.SpriteFrame})],e.prototype,"_spriteFrame",void 0),o([a({type:cc.SpriteFrame})],e.prototype,"spriteFrame",null),o([a({type:cc.Vec2})],e.prototype,"_vertexes",void 0),o([a({type:cc.Vec2})],e.prototype,"vertexes",null),o([p,l,u(cc.MeshRenderer)],e)}(cc.Component);r.default=f,cc._RF.pop()},{}]},{},["Game","Knife","PolygonMask"]);